<!DOCTYPE html>
  <meta charset="UTF-8">
  <title>Nearly BlackJack!</title>

  <body>
  <h1>Nearly BlackJack!</h1>

  <p>Welcome to my game! It's almost BlackJack, but isn't!</p>
  <p>No chips. No dealer to play against. Try to score close to 21 without going over.</p> 
  <p>It's nearly fun!</p>

  <button type="button" onclick="play()">Play!</button>


<script>
  var ranks = new Array("Ace", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Jack", "Queen", "King");
  var suits = new Array("Diamonds", "Clubs", "Hearts", "Spades");
  var userInput, d, h
  
  function Deck() {
  	this.cards = [];
  	this.build = function() {
      
  	  for(s = 0; s <= 3; s++){
  	    for(r = 0;r <= 12; r++){
  		  this.cards.push(new Card(ranks[r], suits[s]));
  		  }
  	  }
      var m = this.cards.length, temp, rand;
        while(m > 0) {
          rand = Math.floor(Math.random() * m--);
          temp = this.cards[m];
          this.cards[m] = this.cards[rand];
          this.cards[rand] = temp;
      }
    }	
  }

  function Card(rank, suit) {
  	this.rank = rank;
  	this.suit = suit;
  	this.show = function() {
  	  console.log(this.rank + " of " + this.suit);
  	}
  }

  function Hand() {
    this.value = 0;
  	this.cards = [];
  	this.draw = function(num) {
      for(i = 1; i <= num; i++){
        this.cards.push(d.cards.pop());
      }
  	}
    this.evaluate = function() {
      var numOfAces = 0;
      this.value = 0;
      for(i = 0; i < this.cards.length; i++) {
        if(h.cards[i].rank == "Ace") {
          numOfAces++;
        }
        else if(ranks.indexOf(this.cards[i].rank) >= 10) {
          this.value += 10;
        }
        else {
          this.value += ranks.indexOf(this.cards[i].rank) + 1;
        }
      }
      this.value += (numOfAces * 11);

      while(this.value > 21 && numOfAces > 0) {
        this.value -= 10;
        numOfAces--;
      }
    }
    this.display = function() {
      for(i = 0; i < this.cards.length; i++) {
        console.log(this.cards[i].rank + " of " + this.cards[i].suit);
      }
      this.evaluate();
      console.log("Points: " + this.value);
    }
  }


  

  function play() {
    d = new Deck();
    d.build();

    h = new Hand();
    h.draw(2);
    h.display();
 
  

  while(h.value <= 21){
    userInput = prompt("Hit or Stay?");
    if(userInput == "hit") {
      h.draw(1);
      h.display();
    }
    else if(userInput == "stay") {
      h.display();
      console.log("Stayed.");
      break;
    }
    else {
      console.log("Please enter 'hit' or 'stay'");
    }
  }

  if(h.value == 21) {
  console.log("BlackJack!");
  }
  else if(h.value < 21) {
    console.log("Stayed at " + h.value);
  }
  else {
    console.log("Bust!");
  }
}

</script>

</body>
</html>
